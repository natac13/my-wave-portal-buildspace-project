(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8912:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return T}});var a=n(3789),r=n(266),s=n(318),i=n(809),o=n.n(i),u=n(4065),c=n(1508),l=n(2658),d=n(2501),p=n(9062),v=n(5295),m=n(8515),f=n(2643),h=n(7294),x=n(8667),g=n(387),y=n(5755),w=JSON.parse('{"Mt":[{"inputs":[],"stateMutability":"payable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"from","type":"address"},{"indexed":false,"internalType":"uint256","name":"timestamp","type":"uint256"},{"indexed":false,"internalType":"string","name":"message","type":"string"}],"name":"NewWave","type":"event"},{"inputs":[],"name":"getAllWaves","outputs":[{"components":[{"internalType":"address","name":"waver","type":"address"},{"internalType":"string","name":"message","type":"string"},{"internalType":"uint256","name":"timestamp","type":"uint256"}],"internalType":"struct WavePortal.Wave[]","name":"","type":"tuple[]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getTotalWaves","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"lastWavedAt","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_message","type":"string"}],"name":"wave","outputs":[],"stateMutability":"nonpayable","type":"function"}]}'),b=n(5893),Z=n(4155),k=w.Mt,j="0x50049107E263e5890A061C304f25216bA2624fB0";function T(){var e=h.useState(""),t=(0,s.Z)(e,2),n=t[0],i=t[1],w=h.useState(!1),T=(0,s.Z)(w,2),W=T[0],C=T[1],_=h.useState(0),N=(0,s.Z)(_,2),S=N[0],M=N[1],E=h.useState([]),A=(0,s.Z)(E,2),D=A[0],F=A[1],O=h.useState(""),P=(0,s.Z)(O,2),q=P[0],z=P[1],G=h.useState(""),H=(0,s.Z)(G,2),Q=H[0],I=H[1],R=function(){var e=(0,r.Z)(o().mark((function e(){var t,n,a,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=window,n=t.ethereum){e.next=7;break}return console.log("Make sure you have metamask!"),e.abrupt("return");case 7:console.log("We have the ethereum object",n);case 8:return e.next=10,n.request({method:"eth_accounts"});case 10:0!==(a=e.sent).length?(r=a[0],console.log("Found an authorized account:",r),i(r)):console.log("No authorized account found"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=(0,r.Z)(o().mark((function e(){var t,n,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=window,n=t.ethereum){e.next=5;break}return alert("Get MetaMask!"),e.abrupt("return");case 5:return e.next=7,n.request({method:"eth_requestAccounts"});case 7:a=e.sent,console.log("Connected",a[0]),i(a[0]),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}(),B=function(){var e=(0,r.Z)(o().mark((function e(){var t,n,a,r,s,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=window,n=t.ethereum,console.log(Z.env.CONTRACT_ADDRESS),!n){e.next=13;break}return a=new y.Q(n),r=a.getSigner(),s=new g.CH(j,k,r),e.next=9,s.getTotalWaves();case 9:i=e.sent,M(null===i||void 0===i?void 0:i.toNumber()),e.next=14;break;case 13:console.log("Ethereum object doesn't exist!");case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=(0,r.Z)(o().mark((function e(){var t,n,a,r,s,i,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=window,!(n=t.ethereum)||!q){e.next=21;break}return a=new y.Q(n),r=a.getSigner(),s=new g.CH(j,k,r),e.next=8,s.wave(q,{gasLimit:3e5});case 8:return i=e.sent,C(!0),e.next=12,i.wait();case 12:return C(!1),z(""),I(""),e.next=17,s.getTotalWaves();case 17:u=e.sent,M(null===u||void 0===u?void 0:u.toNumber()),e.next=22;break;case 21:I("You need to include a message.");case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(0),console.log(e.t0);case 27:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=(0,r.Z)(o().mark((function e(){var t,n,r,s,i,u,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=window,!(n=t.ethereum)){e.next=15;break}return r=new y.Q(n),s=r.getSigner(),i=new g.CH(j,k,s),e.next=8,i.getAllWaves();case 8:u=e.sent,console.log({waves:u}),c=u.map((function(e){return{address:e.waver,timestamp:new Date(1e3*e.timestamp),message:e.message}})),F(c),i.on("NewWave",(function(e,t,n){console.log("NewWave",e,t,n),F((function(r){return[].concat((0,a.Z)(r),[{address:e,timestamp:new Date(1e3*t),message:n}])}))})),e.next=16;break;case 15:console.log("Ethereum object doesn't exist!");case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(){return e.apply(this,arguments)}}();return h.useEffect((function(){R(),B()}),[]),(0,b.jsxs)(u.Z,{maxWidth:"md",children:[(0,b.jsxs)(c.Z,{component:"header",sx:{display:"flex",justifyContent:"center",alignItems:"center",flexFlow:"column",my:2},children:[(0,b.jsx)(l.Z,{variant:"h1",align:"center",fontWeight:"700",children:"Wave Counter"}),(0,b.jsxs)(l.Z,{variant:"h3",align:"center",fontWeight:"700",children:["Total: ",S]})]}),(0,b.jsx)(c.Z,{}),(0,b.jsxs)(c.Z,{sx:{my:3,display:"flex",width:"100%",justifyContent:"center",flexFlow:"column",gap:2},children:[(0,b.jsx)(x.Z,{variant:"outlined",color:"primary",onClick:B,disabled:W,children:"Get Wave Count"}),(0,b.jsx)(x.Z,{variant:"contained",color:"primary",onClick:L,disabled:W,children:"Get All Waves"}),(0,b.jsx)(d.Z,{name:"message",label:"Wave Message",value:q,fullWidth:!0,color:"secondary",helperText:Q,disabled:W,error:!!Q,onChange:function(e){var t,n;n=null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value,I(""),z(n)}}),(0,b.jsx)(x.Z,{variant:"contained",color:"secondary",onClick:J,disabled:W,children:"Wave"}),!n&&(0,b.jsx)(x.Z,{color:"primary",variant:"outlined",onClick:X,disabled:W,children:"Connect Wallet"})]}),W&&(0,b.jsxs)(c.Z,{sx:{display:"flex",flexFlow:"column",width:"100%",alignItems:"center",justifyContent:"center"},children:[(0,b.jsx)(l.Z,{variant:"subtitle1",align:"center",children:"Pending Transaction"}),(0,b.jsx)(p.Z,{color:"secondary",size:50})]}),(0,b.jsx)(c.Z,{children:null===D||void 0===D?void 0:D.map((function(e,t){return(0,b.jsxs)(v.Z,{sx:{mb:2},children:[(0,b.jsx)(m.Z,{title:null===e||void 0===e?void 0:e.address}),(0,b.jsxs)(f.Z,{children:[(0,b.jsxs)(l.Z,{children:["Time: ",null===e||void 0===e?void 0:e.timestamp.toString()]}),(0,b.jsxs)(l.Z,{children:["Message: ",null===e||void 0===e?void 0:e.message]})]})]},t)}))})]})}},5301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(8912)}])},6601:function(){}},function(e){e.O(0,[959,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);